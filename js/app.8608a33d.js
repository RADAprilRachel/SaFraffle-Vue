(function(t){function e(e){for(var a,n,i=e[0],c=e[1],l=e[2],m=0,d=[];m<i.length;m++)n=i[m],Object.prototype.hasOwnProperty.call(o,n)&&o[n]&&d.push(o[n][0]),o[n]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(t[a]=c[a]);u&&u(e);while(d.length)d.shift()();return r.push.apply(r,l||[]),s()}function s(){for(var t,e=0;e<r.length;e++){for(var s=r[e],a=!0,i=1;i<s.length;i++){var c=s[i];0!==o[c]&&(a=!1)}a&&(r.splice(e--,1),t=n(n.s=s[0]))}return t}var a={},o={app:0},r=[];function n(e){if(a[e])return a[e].exports;var s=a[e]={i:e,l:!1,exports:{}};return t[e].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=t,n.c=a,n.d=function(t,e,s){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)n.d(s,a,function(e){return t[e]}.bind(null,a));return s},n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="SaFraffle-Vue/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],c=i.push.bind(i);i.push=e,i=i.slice();for(var l=0;l<i.length;l++)e(i[l]);var u=c;r.push([0,"chunk-vendors"]),s()})({0:function(t,e,s){t.exports=s("56d7")},"034f":function(t,e,s){"use strict";var a=s("85ec"),o=s.n(a);o.a},"182d":function(t,e,s){},"1c85":function(t,e,s){},"2fc3":function(t,e,s){},"56d7":function(t,e,s){"use strict";s.r(e);s("e260"),s("e6cf"),s("cca6"),s("a79d");var a=s("2b0e"),o=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"app"}},[s("link",{attrs:{href:"https://fonts.googleapis.com/css2?family=Dosis&display=swap",rel:"stylesheet"}}),s("div",[s("raffle-display",{attrs:{raffle:t.raffle,ticket_cost:t.raffle.ticket_cost,state:t.state}}),s("raffle-item-display",{attrs:{raffle_items:t.raffle_items,total_tickets:t.total_tickets,total_cost:t.total_cost,total_donation:t.total_donation,total_discount:t.total_discount,ticket_cost:t.raffle.ticket_cost,state:t.state},on:{increment:t.increment,decrement:t.decrement}}),s("checkout-form",{attrs:{state:t.state,total_donation:t.total_donation,total_cost:t.total_cost,total_discount:t.total_discount,itemized_tickets:t.itemized_tickets,custom_id:t.custom_id},on:{checkout:t.checkout,complete:t.paymentComplete}})],1)])},r=[],n=(s("4de4"),s("d81d"),s("13d5"),s("fb6a"),s("b0c0"),s("a9e3"),s("b680"),s("d3b7"),s("25f0"),s("96cf"),s("1da1")),i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"container",attrs:{id:"raffle-display"}},[s("link",{attrs:{href:"https://fonts.googleapis.com/css2?family=Berkshire+Swash&display=swap",rel:"stylesheet"}}),s("link",{attrs:{href:"https://fonts.googleapis.com/css2?family=Josefin+Slab:wght@700&display=swap",rel:"stylesheet"}}),s("link",{attrs:{href:"https://fonts.googleapis.com/css2?family=Dosis&display=swap",rel:"stylesheet"}}),s("meta",{attrs:{name:"viewport",content:"width=500"}}),s("div",{attrs:{id:"header"}},[s("img",{attrs:{src:"http://safraffle.com"+t.raffle.image}})]),s("div",{staticClass:"column"},[s("h1",{staticClass:"title"},[t._v(" "+t._s(t.raffle.name)+" ")]),s("h4",{staticClass:"subtitle"},[t._v(" Benefitting "+t._s(t.raffle.benefactor)+" ")]),s("div",{directives:[{name:"show",rawName:"v-show",value:"shop"===t.state,expression:"state === 'shop'"}],staticClass:"card"},[s("p",[t._v(" "+t._s(t.raffle.description)+" ")]),s("p",[t._v(" Raffle ends on "+t._s(t.raffle.end_date)+" ")]),s("p",[t._v(" Tickets cost $"+t._s(t.ticket_cost)+" each OR get 5 for $"+t._s(4*t.ticket_cost)+"!")])])])])},c=[],l={name:"RaffleDisplay",props:{raffle:Object,state:String,ticket_cost:String}},u=l,m=(s("f28b"),s("2877")),d=Object(m["a"])(u,i,c,!1,null,"e0087836",null),p=d.exports,f=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"container",attrs:{id:"raffle-item-display"}},[s("link",{attrs:{href:"https://fonts.googleapis.com/css2?family=Josefin+Slab:wght@700&display=swap",rel:"stylesheet"}}),s("link",{attrs:{href:"https://fonts.googleapis.com/css2?family=Dosis&display=swap",rel:"stylesheet"}}),t._l(t.raffle_items,(function(e){return s("div",{directives:[{name:"show",rawName:"v-show",value:"shop"===t.state,expression:"state === 'shop'"}],key:e.id,staticClass:"center-container"},[s("div",{class:{"card-sm":t.isSmall(),"card-lg":!t.isSmall()}},[s("div",{staticClass:"card-content"},[s("h3",{staticClass:"subtitle"},[t._v(" "+t._s(e.name)+" ")]),s("p",[t._v(" "+t._s(e.description)+" ")]),s("p",[t._v(" Estimated $"+t._s(e.value)+" value")]),e.image?s("img",{attrs:{src:"http://safraffle.com"+e.image}}):t._e(),s("h5",[t._v(" Donated by "+t._s(e.donor)+" ")])])]),s("div",{class:{"counter-container-lg":!t.isSmall()}},[s("button",{staticClass:"button minus",on:{click:function(s){return t.$emit("decrement",e.id)}}},[t._v("-")]),s("div",{staticClass:"count"},[t._v(t._s(e.ticket_count)+" ")]),s("button",{staticClass:"button plus",on:{click:function(s){return t.$emit("increment",e.id)}}},[t._v("+")]),s("div",[t._v("Tickets")])])])})),s("div",{directives:[{name:"show",rawName:"v-show",value:"shop"===t.state,expression:"state === 'shop'"}],staticClass:"center-container"},[s("div",{class:{"summary-card-sm":t.isSmall(),"summary-card-lg":!t.isSmall()}},[s("p",{staticClass:"totals-label"},[t._v("Total Tickets:")])]),s("div",{class:{"counter-container-sm":t.isSmall(),"counter-container-lg":!t.isSmall()}},[s("p",{staticClass:"totals"},[t._v(t._s(t.total_tickets))])])]),s("div",{directives:[{name:"show",rawName:"v-show",value:t.total_tickets%5-1===3,expression:"total_tickets%5-1 === 3"}],staticClass:"center-container"},[s("p",{staticClass:"notification"},[t._v("You have an unclaimed free ticket! Just add another ticket to redeem it")])]),s("div",{directives:[{name:"show",rawName:"v-show",value:"shop"===t.state&&t.total_discount>0,expression:"state === 'shop' && total_discount > 0"}],staticClass:"center-container"},[s("div",{class:{"summary-card-sm":t.isSmall(),"summary-card-lg":!t.isSmall()}},[s("p",{staticClass:"totals-label"},[t._v("Total Discount:")])]),s("div",{directives:[{name:"show",rawName:"v-show",value:"shop"===t.state&&t.total_discount>0,expression:"state === 'shop' && total_discount > 0"}],class:{"counter-container-sm":t.isSmall(),"counter-container-lg":!t.isSmall()}},[s("p",{staticClass:"totals"},[t._v("-$"+t._s(t.total_discount))])])]),s("div",{directives:[{name:"show",rawName:"v-show",value:"shop"===t.state,expression:"state === 'shop'"}],staticClass:"center-container"},[s("div",{class:{"summary-card-sm":t.isSmall(),"summary-card-lg":!t.isSmall()}},[s("p",{staticClass:"totals-label"},[t._v("Total Donation:")])]),s("div",{class:{"counter-container-sm":t.isSmall(),"counter-container-lg":!t.isSmall()}},[s("p",{staticClass:"totals"},[t._v("$"+t._s(t.total_donation))])])]),s("div",{directives:[{name:"show",rawName:"v-show",value:"checkout"===t.state,expression:"state === 'checkout'"}],staticClass:"center-container"},[s("div",{class:{"table-card-sm":t.isSmall(),"table-card-lg":!t.isSmall()}},[s("table",[t._m(0),s("tbody",t._l(t.raffle_items,(function(e){return s("tr",{key:e.id},[s("td",[t._v(t._s(e.name))]),s("td",[t._v(t._s(e.ticket_count))]),s("td",[t._v("$"+t._s(parseFloat(t.ticket_cost*e.ticket_count).toFixed(2)))])])})),0),s("tfoot",[s("tr",[s("th",[t._v("SubTotal")]),s("th",[t._v(t._s(t.total_tickets))]),s("th",[t._v("$"+t._s(t.total_cost))])]),s("tr",[s("th",[t._v("Discount")]),s("th",[t._v("-")]),s("th",[t._v("-$"+t._s(t.total_discount))])]),s("tr",[s("th",[t._v("Total")]),s("th",[t._v(t._s(t.total_tickets))]),s("th",[t._v("$"+t._s(t.total_donation))])])])])])])],2)},_=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("thead",[s("tr",[s("th",[t._v("Item")]),s("th",[t._v("Tickets")]),s("th",[t._v("Donation")])])])}],h={name:"RaffleItemDisplay",data:function(){return{window_width:window.innerWidth}},methods:{isSmall:function(){return this.window_width<600}},props:{raffle_items:Array,total_tickets:Number,total_cost:String,total_donation:String,total_discount:String,ticket_cost:String,state:String}},v=h,w=(s("cfaa"),Object(m["a"])(v,f,_,!1,null,"01a838f1",null)),y=w.exports,k=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"container",attrs:{id:"checkout-form"}},[s("link",{attrs:{href:"https://fonts.googleapis.com/css2?family=Dosis&display=swap",rel:"stylesheet"}}),s("div",{directives:[{name:"show",rawName:"v-show",value:t.total_donation>0&&"shop"===t.state,expression:"total_donation > 0 && state === 'shop'"}]},[s("form",{attrs:{method:"POST"}},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.customer_name,expression:"customer_name"}],staticClass:"form-input",attrs:{name:"customer_name",placeholder:"Name"},domProps:{value:t.customer_name},on:{input:function(e){e.target.composing||(t.customer_name=e.target.value)}}}),s("p",{directives:[{name:"show",rawName:"v-show",value:!0===t.errors.hasOwnProperty("customer_name"),expression:"errors.hasOwnProperty('customer_name') === true"}],staticClass:"error"},[t._v(t._s(t.errors.customer_name))]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.customer_email,expression:"customer_email"}],staticClass:"form-input",attrs:{name:"customer_email",placeholder:"Email",type:"email"},domProps:{value:t.customer_email},on:{input:function(e){e.target.composing||(t.customer_email=e.target.value)}}}),s("p",{directives:[{name:"show",rawName:"v-show",value:!0===t.errors.hasOwnProperty("customer_email"),expression:"errors.hasOwnProperty('customer_email') === true"}],staticClass:"error"},[t._v(t._s(t.errors.customer_email))]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.customer_phone,expression:"customer_phone"}],staticClass:"form-input",attrs:{name:"customer_phone",placeholder:"Phone",type:"tel"},domProps:{value:t.customer_phone},on:{input:function(e){e.target.composing||(t.customer_phone=e.target.value)}}}),s("p",{directives:[{name:"show",rawName:"v-show",value:!0===t.errors.hasOwnProperty("customer_phone"),expression:"errors.hasOwnProperty('customer_phone') === true"}],staticClass:"error"},[t._v(t._s(t.errors.customer_phone))]),s("label",{staticClass:"select",attrs:{for:"contact_method"}},[s("select",{directives:[{name:"model",rawName:"v-model",value:t.contact_method,expression:"contact_method"}],staticClass:"form-input",attrs:{name:"contact_method"},on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.contact_method=e.target.multiple?s:s[0]}}},[s("option",{attrs:{value:""}},[t._v("Preferred Contact Method")]),s("option",{attrs:{value:"email"}},[t._v("Email")]),s("option",{attrs:{value:"text"}},[t._v("Text")]),s("option",{attrs:{value:"call"}},[t._v("Call")])])]),s("p",{directives:[{name:"show",rawName:"v-show",value:!0===t.errors.hasOwnProperty("contact_method"),expression:"errors.hasOwnProperty('contact_method') === true"}],staticClass:"error"},[t._v(t._s(t.errors.contact_method))])]),s("button",{staticClass:"button",on:{click:t.checkout}},[t._v("Checkout")])]),s("div",{directives:[{name:"show",rawName:"v-show",value:!0===t.errors.hasOwnProperty("cancel"),expression:"errors.hasOwnProperty('cancel') === true"}]},[s("p",{staticClass:"error"},[t._v("Payment not processed!")])]),s("div",{directives:[{name:"show",rawName:"v-show",value:"checkout"===t.state,expression:"state === 'checkout'"}],staticClass:"paypal"},[s("div",{ref:"paypal"})]),s("div",{directives:[{name:"show",rawName:"v-show",value:"complete"===t.state,expression:"state === 'complete'"}]},[s("p",{staticClass:"success"},[t._v("Payment Completed!")]),s("p",[t._v("Thank you for your donation")]),s("p",[t._v("We will contact you if you win. Good luck!")])])])},g=[],b={name:"CheckoutForm",data:function(){return{customer_name:"",customer_email:"",customer_phone:"",contact_method:"",errors:{},credentials:{sandbox:"AdsXXE61inTIs-q731ToP4wjGgKodV8ZYxu53_NU184iGwql8WD8QdKv9eKZQHsNcbYhvLWBUWvJPNQs",production:"<production client id>"}}},props:{state:String,total_donation:String,total_cost:String,total_discount:String,itemized_tickets:Array,custom_id:String},mounted:function(){var t=document.createElement("script");t.src="https://www.paypal.com/sdk/js?client-id=AdsXXE61inTIs-q731ToP4wjGgKodV8ZYxu53_NU184iGwql8WD8QdKv9eKZQHsNcbYhvLWBUWvJPNQs",t.addEventListener("load",this.setLoaded),document.body.appendChild(t)},methods:{setLoaded:function(){var t=this;this.loaded=!0,window.paypal.Buttons({createOrder:function(e,s){return s.order.create({intent:"CAPTURE",purchase_units:[{description:"Raffle tickets for Safai fundraiser",custom_id:t.custom_id,amount:{currency_code:"USD",value:t.total_donation,breakdown:{item_total:{currency_code:"USD",value:t.total_cost},discount:{currency_code:"USD",value:t.total_discount}}},items:t.itemized_tickets}],application_context:{shipping_preference:"NO_SHIPPING"}})},onApprove:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(s,a){var o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,a.order.capture();case 2:o=e.sent,console.log(o),console.log(o.status),t.paymentCompleted(o);case 6:case"end":return e.stop()}}),e)})));function s(t,s){return e.apply(this,arguments)}return s}(),onError:function(e){console.log(e),t.paymentCancelled()},onCancel:function(){t.paymentCancelled()}}).render(this.$refs.paypal)},validate:function(){var t={success:!0,errors:{}};switch(""===this.customer_name&&(t.errors.customer_name="Must enter a name",t.success=!1),this.contact_method){case"email":/\S+@\S+\.\S+/.test(this.customer_email)||(t.errors.customer_email="Must enter a valid email",t.success=!1);break;case"call":case"text":""===this.customer_phone?(t.errors.customer_phone="Must enter a phone number",t.success=!1):this.customer_phone.length<7&&(t.errors.customer_phone="Phone number must be at least 7 digits",t.success=!1);break;default:t.errors.contact_method="Must select a contact method",t.success=!1}return t},checkout:function(){var t=this.validate();this.addPurchase({},this.itemized_tickets,this.custom_id),t.success?(this.errors={},this.$emit("checkout",{customer_name:this.customer_name,customer_email:this.customer_email,customer_phone:this.customer_phone,contect_method:this.contact_method})):this.errors=t.errors},addPurchase:function(t,e,s){return Object(n["a"])(regeneratorRuntime.mark((function a(){var o,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,fetch("https://safraffle.com/api/purchases",{method:"POST",body:JSON.stringify({contact_data:t,itemized_tickets:e,custom_id:s}),headers:{"Content-type":"application/json; charset=UTF-8"}});case 3:return o=a.sent,a.next=6,o.json();case 6:r=a.sent,console.log(r),a.next=13;break;case 10:a.prev=10,a.t0=a["catch"](0),console.error(a.t0);case 13:case"end":return a.stop()}}),a,null,[[0,10]])})))()},paymentCompleted:function(t){this.$emit("complete",t),this.clearCancelError()},paymentCancelled:function(){this.$set(this.errors,"cancel",!0)},clearCancelError:function(){this.$delete(this.errors,"cancel")}}},C=b,S=(s("7b20"),Object(m["a"])(C,k,g,!1,null,null,null)),x=S.exports,O={name:"App",components:{RaffleDisplay:p,RaffleItemDisplay:y,CheckoutForm:x},data:function(){return{state:"shop",raffle:{},raffle_items:[],contact_data:{},paypal_response:{},custom_id:Math.random().toString(36).slice(2)}},computed:{itemized_tickets:function(){var t=this;return this.raffle_items.filter((function(t){return t.ticket_count>0})).map((function(e){return{name:"Raffle ticket for "+e.name,description:"Raffle ticket",quantity:e.ticket_count,unit_amount:{currency_code:"USD",value:t.raffle.ticket_cost},sku:e.id,category:"DIGITAL_GOODS"}}))},total_tickets:function(){return this.raffle_items.reduce((function(t,e){return t+Number(e.ticket_count)}),0)},total_cost:function(){return parseFloat(this.total_tickets*this.raffle.ticket_cost).toFixed(2)},total_donation:function(){return parseFloat(this.total_cost-this.total_discount).toFixed(2)},total_discount:function(){return parseFloat(Math.floor(this.total_tickets/5)*this.raffle.ticket_cost).toFixed(2)}},mounted:function(){this.getRaffleData()},methods:{checkout:function(t){this.state="checkout",this.contact_data=t},paymentComplete:function(t){this.state="complete",this.paypal_response=t},getRaffleData:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var s,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("https://safraffle.com/api/raffles/3/raffleItems");case 3:return s=e.sent,e.next=6,s.json();case 6:a=e.sent,t.raffle=a.data.raffle,t.raffle_items=a.data.raffle_items.map((function(t){return t.ticket_count=0,t})),e.next=14;break;case 11:e.prev=11,e.t0=e["catch"](0),console.error(e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})))()},addPurchase:function(t,e,s){return Object(n["a"])(regeneratorRuntime.mark((function a(){var o,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,fetch("https://saffrafle.com/api/purchases",{method:"POST",body:JSON.stringify({contact_data:t,itemized_tickets:e,custom_id:s}),headers:{"Content-type":"application/json; charset=UTF-8"}});case 3:return o=a.sent,a.next=6,o.json();case 6:r=a.sent,console.log(r),a.next=13;break;case 10:a.prev=10,a.t0=a["catch"](0),console.error(a.t0);case 13:case"end":return a.stop()}}),a,null,[[0,10]])})))()},increment:function(t){this.raffle_items=this.raffle_items.map((function(e){return e.id===t&&e.ticket_count<100?(e.ticket_count+=1,e):e}))},decrement:function(t){this.raffle_items=this.raffle_items.map((function(e){return e.id===t&&e.ticket_count>0?(e.ticket_count-=1,e):e}))}}},P=O,N=(s("034f"),Object(m["a"])(P,o,r,!1,null,null,null)),j=N.exports;a["a"].config.productionTip=!1,new a["a"]({render:function(t){return t(j)}}).$mount("#app")},"7b20":function(t,e,s){"use strict";var a=s("182d"),o=s.n(a);o.a},"85ec":function(t,e,s){},cfaa:function(t,e,s){"use strict";var a=s("2fc3"),o=s.n(a);o.a},f28b:function(t,e,s){"use strict";var a=s("1c85"),o=s.n(a);o.a}});
//# sourceMappingURL=app.8608a33d.js.map